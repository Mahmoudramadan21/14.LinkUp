@tailwind components;
@tailwind utilities;

/*
  highlights.module.css
  - Optimized for HighlightViewerModal and EditHighlightModal
  - Based on stories.module.css with adjustments for highlights (e.g., title styling)
  - Supports dark mode, accessibility, prefers-reduced-motion, and tabbed navigation
  - Uses CSS variables from global.css for consistent theming
*/

/* Keyframes */
@keyframes progressBar {
  0% { width: 0%; }
  100% { width: 100%; }
}

@keyframes fadeInModal {
  0% { opacity: 0; transform: scale(0.95); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes fadeOutModal {
  0% { opacity: 1; transform: scale(1); }
  100% { opacity: 0; transform: scale(0.95); }
}

@keyframes heartPulse {
  0% { transform: scale(1); opacity: 1; }
  20% { transform: scale(1.28); opacity: 0.92; }
  50% { transform: scale(1.08); opacity: 1; }
  100% { transform: scale(1); opacity: 1; }
}

@keyframes swipeHint {
  0% { transform: translateX(0); }
  50% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  .progressBar,
  .fadeInModal,
  .fadeOutModal,
  .heartPulse,
  .swipeHint {
    animation: none !important;
  }
}

/* Utilities */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.will-transform {
  will-change: transform, opacity;
}

/* Modal Styles */
.highlights__viewer_modal {
  @apply fixed inset-0 z-50 flex items-center justify-center bg-[rgba(var(--gray-dark-bg-rgb),0.8)] dark:bg-[rgba(var(--gray-dark-bg-rgb),0.9)];
  display: none;
}

.highlights__viewer_modal_open {
  @apply block;
  animation: fadeInModal 0.3s ease-out forwards;
}

.highlights__viewer_modal_hide {
  @apply block;
  animation: fadeOutModal 0.3s ease-out forwards;
}

.highlights__viewer_overlay {
  @apply fixed inset-0 bg-[rgba(var(--gray-dark-bg-rgb),0.6)] dark:bg-[rgba(var(--gray-dark-bg-rgb),0.8)];
}

.highlights__viewer_container {
  @apply relative w-full max-w-[500px] h-[90vh] max-h-[900px] bg-[var(--gray-card)] dark:bg-[var(--gray-dark-card)] rounded-lg overflow-hidden;
}

.highlights__viewer_content {
  @apply relative flex flex-col h-full;
}

.highlights__viewer_close {
  @apply absolute top-4 right-4 text-white dark:text-[var(--gray-dark-text-primary)] hover:text-[var(--linkup-purple)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
  z-index: 10;
}

.highlights__viewer_progress {
  @apply absolute top-0 left-0 w-full h-1 bg-[rgba(var(--gray-border-rgb),0.3)] dark:bg-[rgba(var(--gray-dark-border-rgb),0.3)];
}

.highlights__viewer_progress_fill {
  @apply h-full bg-[var(--linkup-purple)] dark:bg-[var(--linkup-purple-light)];
  width: 0;
}

.highlights__viewer_title {
  @apply absolute top-6 left-6 text-white dark:text-[var(--gray-dark-text-primary)] text-lg font-semibold z-10 drop-shadow-md;
}

.highlights__viewer_media_wrapper {
  @apply relative flex-1 overflow-hidden;
}

.highlights__viewer_media {
  @apply w-full h-full object-cover;
}

.highlights__viewer_loading {
  @apply absolute inset-0 flex items-center justify-center text-white dark:text-[var(--gray-dark-text-primary)] text-lg;
}

.highlights__viewer_nav {
  @apply absolute inset-y-0 left-0 right-0 flex justify-between pointer-events-none;
}

.highlights__viewer_nav_prev,
.highlights__viewer_nav_next {
  @apply pointer-events-auto bg-[rgba(var(--gray-dark-bg-rgb),0.5)] text-white p-3 rounded-full hover:bg-[rgba(var(--gray-dark-bg-rgb),0.7)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
  top: 50%;
  transform: translateY(-50%);
}

.highlights__viewer_nav_prev {
  @apply left-4;
}

.highlights__viewer_nav_next {
  @apply right-4;
}

.highlights__viewer_nav_hint {
  @apply text-lg will-transform;
}

.highlights__viewer_nav_prev:disabled,
.highlights__viewer_nav_next:disabled {
  @apply opacity-50 cursor-not-allowed;
}

.highlights__viewer_actions {
  @apply absolute bottom-4 left-4 right-4 flex items-center gap-4;
}

.highlights__viewer_latest_viewers {
  @apply flex items-center gap-2 text-white dark:text-[var(--gray-dark-text-primary)] text-sm;
}

.highlights__viewer_avatars_stack {
  @apply flex;
}

.highlights__viewer_avatar_stack {
  @apply relative w-6 h-6 rounded-full border-2 border-[var(--gray-card)] dark:border-[var(--gray-dark-card)] object-cover;
}

.highlights__viewer_count {
  @apply font-medium;
}

.highlights__viewer_action {
  @apply text-white dark:text-[var(--gray-dark-text-primary)] hover:text-[var(--linkup-purple)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
}

.highlights__viewer_like_animate {
  animation: heartPulse 0.88s ease-in-out;
}

.highlights__viewer_menu_button {
  @apply text-white dark:text-[var(--gray-dark-text-primary)] hover:text-[var(--linkup-purple)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
}

.highlights__viewer_menu {
  @apply absolute bottom-12 right-4 bg-[var(--gray-card)] dark:bg-[var(--gray-dark-card)] rounded-md shadow-lg py-1 z-10 min-w-[120px];
}

.highlights__viewer_menu_item {
  @apply flex items-center gap-2 px-4 py-2 text-sm text-[var(--gray-text-primary)] dark:text-[var(--gray-dark-text-primary)] hover:bg-[var(--gray-border)] dark:hover:bg-[var(--gray-dark-border)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
}

/* Reuse animations from feed.module.css */
@keyframes modalFadeIn {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes buttonScale {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

/* Modal overlay */
.highlights__modal-overlay {
  @apply fixed inset-0 bg-[rgba(var(--gray-dark-bg-rgb),0.6)] backdrop-blur-md flex items-center justify-center z-50 transition-opacity duration-300;
}

/* Modal container */
.highlights__modal {
  @apply bg-[var(--gray-card)] dark:bg-[var(--gray-dark-card)] rounded-2xl p-6 w-full max-w-md mx-4 shadow-2xl transform transition-all duration-300;
  box-shadow: 0 10px 30px rgba(var(--gray-dark-bg-rgb), 0.2);
  max-height: 90vh;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--gray-dark-bg-rgb), 0.2) transparent;
}

.highlights__modal::-webkit-scrollbar {
  width: 6px;
}

.highlights__modal::-webkit-scrollbar-track {
  background: transparent;
}

.highlights__modal::-webkit-scrollbar-thumb {
  background: rgba(var(--gray-dark-bg-rgb), 0.2);
  border-radius: 3px;
}

/* Modal header */
.highlights__modal__header {
  @apply flex items-center justify-between mb-4 sticky top-0 bg-[var(--gray-card)] dark:bg-[var(--gray-dark-card)] py-4;
}

/* Modal title */
.highlights__modal__title {
  @apply text-xl font-bold text-[var(--gray-text-primary)] dark:text-[var(--gray-dark-text-primary)];
}

/* Modal buttons (back, close) */
.highlights__modal__button {
  @apply text-[var(--gray-text-secondary)] hover:text-[var(--gray-text-primary)] dark:text-[var(--gray-dark-text-secondary)] dark:hover:text-[var(--gray-dark-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] rounded-full p-2 transition-colors duration-200;
}

/* Modal main content */
.highlights__modal__main {
  @apply relative;
}

/* Step container */
.highlights__step {
  @apply p-4;
}

/* Label for inputs */
.highlights__label {
  @apply block mb-2 font-semibold text-[var(--gray-text-primary)] dark:text-[var(--gray-dark-text-primary)];
}

/* Title input */
.highlights__input {
  @apply w-full p-2 rounded-lg border border-[var(--gray-border)] dark:border-[var(--gray-dark-border)] bg-transparent text-[var(--gray-text-primary)] dark:text-[var(--gray-dark-text-primary)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-shadow duration-200;
}

/* Next/Create button */
.highlights__button {
  @apply px-4 py-2 rounded-lg font-medium text-[var(--gray-card)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-all duration-200;
}

.highlights__button--next {
  @apply bg-[var(--blue-action)] hover:bg-[rgba(var(--blue-action-rgb),0.8)];
}

.highlights__button--create {
  @apply bg-[var(--success)] hover:bg-[rgba(var(--success-rgb),0.8)];
}

.highlights__button:disabled {
  @apply opacity-50 cursor-not-allowed;
}

/* Stories grid for selection */
.highlights__stories_grid {
  @apply grid grid-cols-3 gap-0 overflow-y-auto max-h-96; /* Increased max height, removed gap */
}

/* Story item */
.highlights__story {
  @apply relative cursor-pointer transition-transform duration-200 hover:scale-105 focus:scale-105;
}

.highlights__story--selected {
  @apply border-2 border-[var(--linkup-purple)] rounded-lg;
}

/* Story date */
.highlights__story__date {
  @apply absolute top-2 left-2 text-xs font-medium text-white bg-[rgba(var(--gray-dark-bg-rgb),0.6)] px-2 py-1 rounded-md z-10;
}

/* Story image */
.highlights__story__image {
  @apply rounded-lg object-cover w-full h-48; /* Increased height to 48 (192px) */
}

/* Story check icon for selection */
.highlights__story__check {
  @apply absolute bottom-2 right-2 text-[var(--linkup-purple)] bg-white rounded-full p-1 shadow-md;
}

/* Loading text */
.highlights__loading {
  @apply text-center text-[var(--gray-text-secondary)] dark:text-[var(--gray-dark-text-secondary)] mt-2;
}

/* Cover selection grid */
.highlights__cover_grid {
  @apply grid grid-cols-3 gap-0; /* Removed gap */
}

/* Cover item */
.highlights__cover {
  @apply relative;
}

/* Selected cover */
.highlights__cover--selected {
  @apply border-2 border-[var(--blue-action)];
}

/* Cover image */
.highlights__cover__image {
  @apply rounded-lg object-cover w-full h-48; /* Increased height to 48 (192px) */
}

/* Upload cover label */
.highlights__upload_label {
  @apply flex items-center gap-2 mt-4 text-sm text-[var(--gray-text-secondary)] dark:text-[var(--gray-dark-text-secondary)] cursor-pointer hover:text-[var(--linkup-purple)] dark:hover:text-[var(--linkup-purple-light)] transition-colors duration-200;
}

/* Cover preview */
.highlights__cover_preview {
  @apply mt-2 rounded-lg object-cover w-full h-48; /* Adjusted preview height */
}

/* Skeleton loader */
.highlights__skeleton {
  @apply grid grid-cols-3 gap-0; /* Removed gap */
}

.highlights__skeleton__item {
  @apply w-full h-48 bg-[var(--gray-light)] dark:bg-[var(--gray-dark-border)] rounded-lg animate-pulse; /* Adjusted skeleton height */
}

/* Tab navigation */
.highlights__tabs {
  @apply flex border-b border-[var(--gray-border)] dark:border-[var(--gray-dark-border)];
}

.highlights__tab {
  @apply flex-1 py-2 px-4 text-center text-sm font-medium text-[var(--gray-text-secondary)] dark:text-[var(--gray-dark-text-secondary)] hover:text-[var(--linkup-purple)] dark:hover:text-[var(--linkup-purple-light)] focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)] transition-colors duration-200;
}

.highlights__tab--active {
  @apply text-[var(--linkup-purple)] dark:text-[var(--linkup-purple-light)] border-b-2 border-[var(--linkup-purple)];
}

/* Tab panel */
.highlights__tabpanel {
  @apply w-full;
}

/* Animations with reduced motion check */
@media (prefers-reduced-motion: no-preference) {
  .highlights__modal {
    animation: modalFadeIn 0.3s ease-out;
  }
  .highlights__button:not(:disabled):hover {
    animation: buttonScale 0.2s ease-in-out;
  }
}

/* Light mode shadow */
@media (prefers-color-scheme: light) {
  .highlights__modal {
    box-shadow: 0 10px 30px rgba(var(--gray-bg-rgb), 0.2);
  }
}

/* Character count for title */
.highlights__char-count {
  @apply text-sm text-[var(--gray-text-secondary)] dark:text-[var(--gray-dark-text-secondary)] mt-1 text-right;
}
