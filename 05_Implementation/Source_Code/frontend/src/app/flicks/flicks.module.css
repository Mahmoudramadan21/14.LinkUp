@tailwind components;
@tailwind utilities;

/* Animations (with reduced motion check) */
@keyframes videoGlow {
  0% { box-shadow: 0 0 5px rgba(var(--gray-dark-border-rgb), 0.5); }
  50% { box-shadow: 0 0 15px rgba(var(--gray-dark-border-rgb), 0.8); }
  100% { box-shadow: 0 0 5px rgba(var(--gray-dark-border-rgb), 0.5); }
}

@keyframes modalSlideUp {
  0% { opacity: 0; transform: translateY(100%); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes menuFadeIn {
  0% { opacity: 0; transform: scale(0.95); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes fadeInForm {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 1; transform: translateY(0); }
}

@keyframes buttonScale {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

@keyframes inputGlow {
  0% { box-shadow: 0 0 0 rgba(var(--linkup-purple-rgb), 0.3); }
  50% { box-shadow: 0 0 10px rgba(var(--linkup-purple-rgb), 0.5); }
  100% { box-shadow: 0 0 0 rgba(var(--linkup-purple-rgb), 0.3); }
}

@keyframes videoGlowLight {
  0% { box-shadow: 0 0 5px rgba(var(--gray-border-rgb), 0.3); }
  50% { box-shadow: 0 0 15px rgba(var(--gray-border-rgb), 0.5); }
  100% { box-shadow: 0 0 5px rgba(var(--gray-border-rgb), 0.3); }
}

/* Apply animations only if no reduced motion */
@media (prefers-reduced-motion: no-preference) {
  .flicks__video { animation: videoGlow 3s ease-in-out infinite; }
  .flicks__action-button:hover { animation: buttonScale 0.2s ease-in-out; }
  .flicks__menu { animation: menuFadeIn 0.2s ease-out; }
  .flicks__comment-modal { animation: modalSlideUp 0.3s ease-out; }
  .flicks__comment-form { animation: fadeInForm 0.3s ease-out; }
  .flicks__comment-form-input:focus { animation: inputGlow 2s ease-in-out infinite; }
}

/* Main container */
.flicks {
  @apply relative min-h-screen bg-[var(--gray-dark-bg)] dark:bg-[var(--gray-dark-bg)] text-[var(--gray-dark-text-primary)] dark:text-[var(--gray-dark-text-primary)];
}


/* Wrapper for vertical scroll */
.flicks__wrapper {
  @apply pt-[60px] snap-y snap-mandatory h-screen overflow-y-scroll scroll-smooth;
  scrollbar-width: none;
}

.flicks__wrapper::-webkit-scrollbar {
  display: none;
}

/* Container for each flick (9:16 aspect) */
.flicks__container {
  @apply relative h-[100lvh] snap-center flex items-center justify-center max-w-md mx-auto w-full;
  aspect-ratio: 9/16;
}

/* Video */
.flicks__video {
  @apply w-full h-full object-contain rounded-2xl;
}

/* Overlay */
.flicks__overlay {
  @apply absolute inset-0 bg-gradient-to-b from-transparent to-[rgba(var(--gray-dark-bg-rgb),0.7)] pointer-events-none;
}

.flicks__overlay > * {
  @apply pointer-events-auto;
}

/* User info */
.flicks__info {
  @apply absolute bottom-6 left-4 right-4 z-10;
}

.flicks__user {
  @apply flex w-fit items-center gap-3 bg-[rgba(var(--gray-dark-card-rgb),0.6)] rounded-full p-2 pr-3;
}

.flicks__user-avatar {
  @apply w-10 h-10 rounded-full border-2 border-[var(--gray-dark-border)];
}

.flicks__user-username {
  @apply text-sm font-semibold text-[var(--gray-dark-text-primary)];
}

.flicks__content {
  @apply text-sm text-[var(--gray-dark-text-primary)] bg-[rgba(var(--gray-dark-card-rgb),0.6)] p-3 rounded-xl mt-2 w-[85%] leading-relaxed;
}

/* Actions column */
.flicks__actions {
  @apply absolute right-4 bottom-12 flex flex-col gap-4 z-10;
}

.flicks__action-button {
  @apply flex flex-col items-center gap-1 p-3 bg-[rgba(var(--gray-dark-card-rgb),0.6)] rounded-full text-[var(--gray-dark-text-primary)] backdrop-blur-md transition-all duration-200 hover:bg-[rgba(var(--gray-dark-card-rgb),0.8)] hover:scale-110 focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)];
}

.flicks__action-button--liked {
  @apply text-[var(--error)];
}

.flicks__action-button--saved {
  @apply text-[var(--linkup-purple)] dark:text-[var(--linkup-purple-light)];
}

.flicks__action-count {
  @apply text-xs font-medium;
}

/* Menu */
.flicks__menu {
  @apply absolute right-0 top-0 bg-[var(--gray-dark-card)] rounded-xl p-3 shadow-2xl min-w-[120px] z-20;
}

.flicks__menu-item {
  @apply flex items-center gap-2 p-2 w-full text-left text-sm text-[var(--gray-dark-text-primary)] rounded-lg hover:bg-[rgba(var(--gray-dark-border-rgb),0.5)] transition-colors;
}

/* Mute/Play buttons */
.flicks__mute-button {
  @apply absolute top-6 right-6 p-3 bg-[rgba(var(--gray-dark-card-rgb),0.6)] rounded-full text-[var(--gray-dark-text-primary)] hover:bg-[rgba(var(--gray-dark-card-rgb),0.8)] transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)];
}

.flicks__play-pause-button {
  @apply absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-[rgba(var(--gray-dark-card-rgb),0.6)] rounded-full flex items-center justify-center text-[var(--gray-dark-text-primary)] border-2 border-[rgba(var(--gray-dark-border-rgb),0.5)] opacity-80 hover:opacity-100 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)];
}

/* Comment Modal */
.flicks__comment-modal {
  @apply max-w-md m-auto fixed bottom-0 left-0 right-0 h-[85vh] bg-[var(--gray-dark-card)] rounded-t-3xl z-50 shadow-2xl;
}

.flicks__comment-modal-content {
  @apply flex flex-col h-full overflow-hidden;
}

.flicks__comment-modal-header {
  @apply flex items-center justify-between p-4 border-b border-[var(--gray-dark-border)];
}

.flicks__comment-modal-title {
  @apply text-xl font-bold text-[var(--gray-dark-text-primary)];
}

.flicks__comment-modal-close {
  @apply text-[var(--gray-dark-text-secondary)] hover:text-[var(--gray-dark-text-primary)] p-2 rounded-full transition-colors;
}

.flicks__comment-modal-body {
  @apply flex-1 overflow-y-auto p-4 space-y-4;
  scrollbar-width: thin;
  scrollbar-color: var(--gray-dark-border);
  scrollbar-track-color: transparent
}

.flicks__comment-load-more {
  @apply text-center pt-4;
}

.flicks__load-more-button {
  @apply px-4 py-2 bg-[rgba(var(--linkup-purple-rgb),0.2)] text-[var(--linkup-purple)] rounded-full text-sm font-semibold hover:bg-[rgba(var(--linkup-purple-rgb),0.3)] transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)];
}

/* Comment Form */
.flicks__comment-form {
  @apply flex items-center gap-3 p-4 border-t border-[var(--gray-dark-border)] bg-[rgba(var(--gray-dark-card-rgb),0.5)];
}

.flicks__comment-form-inner {
  @apply flex items-center gap-3 flex-1;
}

.flicks__comment-form-avatar {
  @apply w-8 h-8 rounded-full;
}

.flicks__comment-form-input {
  @apply flex-1 p-3 rounded-2xl border-none bg-[rgba(var(--gray-dark-border-rgb),0.5)] text-[var(--gray-dark-text-primary)] placeholder-[var(--gray-dark-text-secondary)] text-sm focus:outline-none focus:bg-[rgba(var(--gray-dark-border-rgb),0.7)] transition-colors;
}

.flicks__comment-form-button {
  @apply bg-[var(--linkup-purple)] text-[var(--gray-card)] p-3 rounded-full transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-[var(--linkup-purple)];
}

.flicks__comment-form-button--disabled {
  @apply opacity-50 scale-100 cursor-not-allowed;
}

.flicks__comment-form-spinner {
  @apply w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin;
}

.flicks__comment-form-error {
  @apply text-[var(--error)] text-xs mt-1 ml-3;
}

/* Load more & Loading */
.flicks__load-more {
  @apply h-4;
}

.flicks__loading {
  @apply absolute inset-0 flex items-center justify-center text-[var(--gray-dark-text-secondary)];
}

.flicks__loading-spinner {
  @apply w-6 h-6 border-2 border-t-[var(--gray-dark-text-secondary)] rounded-full animate-spin mr-2;
  border-color: rgba(var(--gray-dark-text-secondary), 0.7);
}

/* Light Mode Overrides */
@media (prefers-color-scheme: light) {
  .flicks { @apply bg-[var(--gray-bg)] text-[var(--gray-text-primary)]; }
  .flicks__video { animation: videoGlowLight 3s ease-in-out infinite; }
  .flicks__user { @apply bg-[rgba(var(--gray-card-rgb),0.8)]; }
  .flicks__user-username, .flicks__content { @apply text-[var(--gray-text-primary)]; }
  .flicks__action-button { @apply text-[var(--gray-text-primary)] bg-[rgba(var(--gray-card-rgb),0.8)] hover:bg-[rgba(var(--gray-card-rgb),0.9)]; }
  .flicks__action-count { @apply text-[var(--gray-text-primary)]; }
  .flicks__comment-modal { @apply bg-[var(--gray-card)]; }
  .flicks__comment-modal-title { @apply text-[var(--gray-text-primary)]; }
  .flicks__comment-form-input { @apply bg-[rgba(var(--gray-border-rgb),0.5)] text-[var(--gray-text-primary)] placeholder-[var(--gray-text-secondary)]; }
  .flicks__header { @apply bg-[rgba(var(--gray-card-rgb),0.8)]; }
  .flicks__back-icon, .flicks__camera-icon, .flicks__title { @apply text-[var(--gray-text-primary)]; }
}

/* Responsive */
@media (max-width: 480px) {
  .flicks__container { @apply max-w-none; }
  .flicks__info { @apply bottom-4 left-2 right-2; }
  .flicks__actions { @apply right-2 gap-3; }
}

/* High Contrast */
@media (prefers-contrast: high) {
  .flicks__action-button {
     @apply border; 
  border-color: rgba(var(var(--gray-dark-border)), 0.5);
    
    }
}